<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>The Fly CLI</title><link type="text/css" rel="stylesheet" href="public/anatomy.css" /><link type="text/css" rel="stylesheet" href="public/highlight.css" /><script type="text/javascript" src="public/jquery.js"></script><script type="text/javascript" src="public/jquery.hotkeys.js"></script><script type="text/javascript" src="public/tags_fly-cli.js"></script><script type="text/javascript" src="public/main.js"></script></head><body class="normal"><div id="main"><div id="content"><div class="section" id="section_fly-cli"><h1 class="section_header"><a name="fly-cli"></a>The Fly CLI</h1><p>The <code>fly</code> tool is a command line interface to Concourse. It is used for
a number of tasks from connecting to a shell in one of your build&#39;s
containers to uploading new pipeline configuration into a running Concourse.
Learning how to use <code>fly</code> will make using Concourse faster and more
useful.</p><p>You can download <code>fly</code> from a Concourse. There are download links for
common platforms in the bottom right hand corner of the main page.</p><div class="section" id="section_targeting-your-concourse"><h2 class="section_header"><a name="targeting-your-concourse"></a>Targeting your Concourse</h2><p>Fly works with an already deployed Concourse. If you don&#39;t already have one of
these you should follow the @seclink[&quot;deploying-with-vagrant&quot;]Deploying
  with Vagrant oreferencedeploying-with-boshDeploying with BOSH guides
to deploy a Concourse.</p><p>Once you&#39;ve deployed Concourse you can tell <code>fly</code> to target it via the
<code>--target</code> flag. For example, if we wanted to run @codefly sync (don&#39;t
worry what this means just yet) while pointing at Concourse that you normally
reach by going to <code>http://ci.example.com</code> then you could run:</p><div class="highlight"><pre class="verbatim"><span class="nv">$ </span><span class="t">fly</span><span class="t"> </span><span class="t">--target</span><span class="t"> </span><span class="s1">&#39;http://ci.example.com&#39;</span><span class="t"> </span><span class="t">sync</span></pre></div><p><blockquote>The default Vagrant address is set as the default target in <code>fly</code>. This
means that you don&#39;t need to do anything extra if you are using the Vagrant
boxes to deploy Concourse.</blockquote></p><p>The single quotes aren&#39;t always required, but if you need to put HTTP basic
authentication credentials inline, then they can help by avoiding the need to
escape special characters in passwords. For example:</p><div class="highlight"><pre class="verbatim"><span class="nv">$ </span><span class="t">fly</span><span class="t"> </span><span class="t">--target</span><span class="t"> </span><span class="s1">&#39;http://username:p@$$w0rd@ci.example.com&#39;</span><span class="t"> </span><span class="t">sync</span></pre></div><p>If your Concourse uses SSL but does not have a CA signed certificate, you
can use the <code>-k</code> or @code--insecure flag in order to make @codefly
not check the remote certificates.</p><p>For the rest of this document it is assumed you are setting the target in
each of the commands and so it will not be included for brevity.</p></div><div class="section" id="section_fly-save-target"><h2 class="section_header"><a name="fly-save-target"></a><code>save-target</code>: Saving Concourse Targets</h2><p>Using <code>save-target</code> allows you to save a named target to a @code.flyrc
file stored in your home directory, so that you don&#39;t have to repeat the full
URL for every command. Passing the name of a saved target via <code>--target</code>
(or <code>-t</code> for short) will look up its details from your @code.flyrc and
use them in the call specified.</p><p>The <code>--api</code> flag and a target name are the only two properties required
to save a target:</p><div class="highlight"><pre class="verbatim"><span class="nv">$ </span><span class="t">fly</span><span class="t"> </span><span class="t">save-target</span><span class="t"> </span><span class="t">--api</span><span class="t"> </span><span class="t">https://example.com</span><span class="t"> </span><span class="t">my-target</span></pre></div><p>The full set of properties can be specified as such:</p><div class="highlight"><pre class="verbatim"><span class="nv">$ </span><span class="t">fly</span><span class="t"> </span><span class="t">save-target</span><span class="t"> </span><span class="t">--api</span><span class="t"> </span><span class="t">https://example.com</span><span class="t"> </span><span class="t">--username</span><span class="t"> </span><span class="t">my-user</span><span class="t">
</span><span class="t">--password</span><span class="t"> </span><span class="t">my-password</span><span class="t"> </span><span class="t">my-target</span></pre></div></div><div class="section" id="section_fly-execute"><h2 class="section_header"><a name="fly-execute"></a><code>execute</code>: Submitting Local Tasks</h2><p>One of the most common use cases of <code>fly</code> is taking a local project on
your computer and submitting it up with a task configuration to be run
inside a container in Concourse. This is useful to build Linux projects on
OS X or to avoid all of those debugging commits when something is configured
differently between your local and remote setup.</p><p>If you have a task configuration called <code>task.yml</code> that describes a
task that only requires a single input, whose contents are in the current
directory (e.g. most unit tests and simple integration tests) then you can
just run:</p><div class="highlight"><pre class="verbatim"><span class="nv">$ </span><span class="t">fly</span><span class="t"> </span><span class="t">execute</span></pre></div><p>Your files will be uploaded and the task will be executed with them. The
working directory name will be used as the input name. If they do not match,
you must specify <code>-i name=.</code> instead, where @codename is the input
name from the task configuration.</p><p>Fly will automatically capture <code>SIGINT</code> and @codeSIGTERM and abort the
build when received. This allows it to be transparently composed with other
toolchains.</p><p>If your task configuration is in a non-standard location then you can
specify it using the <code>-c</code> or @code--config argument like so:</p><div class="highlight"><pre class="verbatim"><span class="nv">$ </span><span class="t">fly</span><span class="t"> </span><span class="t">execute</span><span class="t"> </span><span class="t">-c</span><span class="t"> </span><span class="t">tests.yml</span></pre></div><p>If you have many extra files or large files in your currect directory that
would normally be ignored by your version control system, then you can use
the <code>-x</code> or @code--exclude-ignored flags in order to limit the files
that you send to Concourse to just those that are not ignored.</p><p>If your task needs to run as <code>root</code> then you can specify the @code-p
or <code>--privileged</code> flag.</p><div class="section" id="section_multiple-inputs-to-locally-submitted-tasks"><h3 class="section_header"><a name="multiple-inputs-to-locally-submitted-tasks"></a>Multiple Inputs to Locally Submitted Tasks</h3><p>Tasks in Concourse can take multiple inputs. Up until now we&#39;ve just been
submitting a single input (our current working directory) that has the same
name as the directory.</p><p>Tasks must specify the inputs that they require (for more information, refer
to theeferenceconfiguring-tasksconfiguring tasks documentation). For
<code>fly</code> to upload these inputs you can use the @code-i or
<code>--input</code> arguments with name and path pairs. For example:</p><div class="highlight"><pre class="verbatim"><span class="nv">$ </span><span class="t">fly</span><span class="t"> </span><span class="t">execute</span><span class="t"> </span><span class="t">-i</span><span class="t"> </span><span class="nv">code</span><span class="t"></span><span class="o">=</span><span class="t">.</span><span class="t"> </span><span class="t">-i</span><span class="t"> </span><span class="nv">stemcells</span><span class="t"></span><span class="o">=</span><span class="t">../stemcells</span></pre></div><p>This would work together with a <code>task.yml</code> if its @codeinputs:
section was as follows:</p><pre class="verbatim">inputs:
- name: code
- name: stemcells</pre><p>If you specify an input then the default input will no longer be added
automatically and you will need to explicitly list it (as with the
<code>code</code> input above).</p><p>This feature can be used to mimic other resources and try out combinations
of input that would normally not be possible in a pipeline.</p></div></div><div class="section" id="section_fly-configure"><h2 class="section_header"><a name="fly-configure"></a><code>configure</code>: Configuring Pipelines</h2><p>Fly can be used to fetch and update the configuration for your pipelines. This
is achieved by using the <code>configure</code> command. For example, to fetch the
current configuration of your <code>my-pipeline</code> Concourse pipeline and print
it on <code>STDOUT</code> run the following:</p><div class="highlight"><pre class="verbatim"><span class="nv">$ </span><span class="t">fly</span><span class="t"> </span><span class="t">configure</span><span class="t"> </span><span class="t">my-pipeline</span></pre></div><p>To get JSON instead of YAML you can use the <code>-j</code> or @code--json
argument. This can be useful when inspecting your config with
<a href="http://stedolan.github.io/jq/">jq</a>.</p><p>To submit a pipeline configuration to Concourse from a file on your local disk
you can use the <code>-c</code> or @code--config flag, like so:</p><div class="highlight"><pre class="verbatim"><span class="nv">$ </span><span class="t">fly</span><span class="t"> </span><span class="t">configure</span><span class="t"> </span><span class="t">--config</span><span class="t"> </span><span class="t">pipeline.yml</span><span class="t"> </span><span class="t">my-pipeline</span></pre></div><p>This will present a diff of the changes and ask you to confirm the changes.
If you accept then Concourse&#39;s pipeline configuration will switch to the
pipeline definition in the YAML file specified.</p><div class="section" id="section_parameters"><h3 class="section_header"><a name="parameters"></a>Parameters</h3><p>The pipeline configuration can contain templates in the form of
<code>foo-bar</code>. They will be replaced with string values populated by
repeated <code>--var</code> or @code--vars-from flags.</p><p>This allows for credentials to be extracted from a pipeline config, making it
safe to check in to a public repository or pass around.</p><p>For example, if you have a <code>pipeline.yml</code> as follows:</p><pre class="verbatim">resources:
- name: private-repo
  type: git
  source:
    uri: git@...
    branch: master
    private_key: private-repo-key</pre><p>...you could then configure this pipeline like so:</p><div class="highlight"><pre class="verbatim"><span class="nv">$ </span><span class="t">fly</span><span class="t"> </span><span class="t">configure</span><span class="t"> </span><span class="t">--config</span><span class="t"> </span><span class="t">pipeline.yml</span><span class="t"> </span><span class="t">--var</span><span class="t"> </span><span class="s2">&quot;private-repo-key=$(cat id_rsa)&quot;</span><span class="t"> </span><span class="t">my-pipeline</span></pre></div><p>Or, if you had a <code>credentials.yml</code> as follows:</p><pre class="verbatim">private-repo-key: |
  -----BEGIN RSA PRIVATE KEY-----
  ...
  -----END RSA PRIVATE KEY-----</pre><p>...you could configure it like so:</p><div class="highlight"><pre class="verbatim"><span class="nv">$ </span><span class="t">fly</span><span class="t"> </span><span class="t">configure</span><span class="t"> </span><span class="t">--config</span><span class="t"> </span><span class="t">pipeline.yml</span><span class="t"> </span><span class="t">--vars-from</span><span class="t"> </span><span class="t">credentials.yml</span><span class="t"> </span><span class="t">my-pipeline</span></pre></div><p>If both <code>--var</code> and @code--vars-from are specified, the @code--var
flags take precedence.</p></div></div><div class="section" id="section_fly-destroy-pipeline"><h2 class="section_header"><a name="fly-destroy-pipeline"></a><code>destroy-pipeline</code>: Removing Pipelines</h2><p>Every now and then you just don&#39;t want a pipeline to be around anymore.
Running <code>fly destroy-pipeline</code> will stop the pipeline activity and remove
all data collected by the pipeline, including build history and collected
versions.</p></div><div class="section" id="section_fly-intercept"><h2 class="section_header"><a name="fly-intercept"></a><code>intercept</code>: Accessing a running or recent build&#39;s steps</h2><p>Sometimes it&#39;s helpful to be on the same machine as your tasks so that you
can profile or inspect them as they run or see the state the machine at the
end of a run. Due to Concourse running tasks in containers on remote
machines this would typically be hard to access. To this end, there is a
<code>fly intercept</code> command that will give you a shell inside the most
recent one-off build that was submitted to Concourse. For example, running
the following will run a task and then enter the finished task&#39;s
container:</p><p><blockquote>Be warned, if more than one person is using a Concourse server for running
one-off builds then you may end up in a build that you did not expect!</blockquote></p><div class="highlight"><pre class="verbatim"><span class="nv">$ </span><span class="t">fly</span><span class="t"> </span><span class="t">execute</span><span class="t">
</span><span class="nv">$ </span><span class="t">fly</span><span class="t"> </span><span class="t">intercept</span></pre></div><p>Containers are around for a short time after a build in order to allow
people to intercept them.</p><p>You can also intercept builds that were run in your pipeline. By using the
<code>-j</code> or @code--job and @code-b or @code--build you can pick out a
specific job and build to intercept.</p><p>The shell created on the remote container via <code>fly intercept</code> provides
root user access by default.</p><p><blockquote>The command <code>fly hijack</code> is an alias of @codefly intercept. Both can
be used interchangably.</blockquote></p><p>@centered@image[&quot;images/fly-demo.png&quot;]Fly Demo</p><p>A specific command can also be given, e.g. <code>fly intercept ps auxf</code> or
<code>fly intercept htop</code>. This allows for patterns such as @codewatch fly
  intercept ps auxf, which will continuously show the process tree of the
current build&#39;s task, even as the &quot;current build&quot; changes.</p></div><div class="section" id="section_fly-sync"><h2 class="section_header"><a name="fly-sync"></a><code>sync</code>: Update your local copy of @codefly</h2><p>Occasionally we add additional features to <code>fly</code> or make changes to the
communiction between it and Concourse&#39;s API server. To make sure you&#39;re
running the latest and greatest version that works with the Concourse you
are targeting we provide a command called <code>sync</code> that will update your
local <code>fly</code>. It can be used like so:</p><div class="highlight"><pre class="verbatim"><span class="nv">$ </span><span class="t">fly</span><span class="t"> </span><span class="t">sync</span></pre></div></div><div class="section" id="section_fly-watch"><h2 class="section_header"><a name="fly-watch"></a><code>watch</code>: View logs of in-progress builds</h2><p>Concourse emits streaming colored logs on the website but it can be helpful
to have the logs availiable to the command line. (e.g. so that they can be
processed by other commands).</p><p>The <code>watch</code> command can be used to do just this. You can also view
builds that were run in your pipeline. By using the <code>-j</code> or
<code>--job</code> and @code-b or @code--build you can pick out a specific job
and build to watch. For example, the following command will either show the
archived logs for an old build if it has finished running or it will stream
the current logs if the build is still in progress.</p><div class="highlight"><pre class="verbatim"><span class="nv">$ </span><span class="t">fly</span><span class="t"> </span><span class="t">watch</span><span class="t"> </span><span class="t">--job</span><span class="t"> </span><span class="t">tests</span><span class="t"> </span><span class="t">--build</span><span class="t"> </span><span class="t">52</span></pre></div></div></div></div></div><div class="search"><form action="javascript:void(0)"><input type="text" placeholder="Search&hellip;" autocomplete="off" id="search" /></form><ul class="search_results"></ul></div><div id="sidebar"><h4>On this page:</h4><ol class="toc"><li><a href="fly-cli.html#targeting-your-concourse">Targeting your Concourse</a></li><li><a href="fly-cli.html#fly-save-target"><code>save-target</code>: Saving Concourse Targets</a></li><li><a href="fly-cli.html#fly-execute"><code>execute</code>: Submitting Local Tasks</a><ol><li><a href="fly-cli.html#multiple-inputs-to-locally-submitted-tasks">Multiple Inputs to Locally Submitted Tasks</a></li></ol></li><li><a href="fly-cli.html#fly-configure"><code>configure</code>: Configuring Pipelines</a><ol><li><a href="fly-cli.html#parameters">Parameters</a></li></ol></li><li><a href="fly-cli.html#fly-destroy-pipeline"><code>destroy-pipeline</code>: Removing Pipelines</a></li><li><a href="fly-cli.html#fly-intercept"><code>intercept</code>: Accessing a running or recent build&#39;s steps</a></li><li><a href="fly-cli.html#fly-sync"><code>sync</code>: Update your local copy of @codefly</a></li><li><a href="fly-cli.html#fly-watch"><code>watch</code>: View logs of in-progress builds</a></li></ol><h4>Up one level:</h4><ol class="toc"><li><a href="index.html">Concourse: CI that scales with your project</a><ol><li><a href="what-and-why.html">What &amp; Why</a><ol><li><a href="what-and-why.html#simple">Simple</a></li><li><a href="what-and-why.html#usable">Usable</a></li><li><a href="what-and-why.html#isolated-builds">Isolated Builds</a></li><li><a href="what-and-why.html#scalable-reproducible-deployment">Scalable, reproducible deployment</a></li><li><a href="what-and-why.html#flexible">Flexible</a></li><li><a href="what-and-why.html#local-iteration">Local iteration</a></li><li><a href="what-and-why.html#bootstrapped">Bootstrapped</a></li></ol></li><li><a href="concepts.html">Concepts</a><ol><li><a href="tasks.html">Tasks</a><ol><li><a href="tasks.html#runtime-environment">Runtime Environment</a></li></ol></li><li><a href="resources.html">Resources</a></li><li><a href="jobs.html">Jobs</a><ol><li><a href="jobs.html#job-builds">Builds</a></li></ol></li></ol></li><li><a href="getting-started.html">Getting Started</a><ol><li><a href="getting-started.html#deploying-with-vagrant">Provisioning with Vagrant</a></li><li><a href="getting-started.html#deploying-with-bosh">Deploying a cluster with BOSH</a><ol><li><a href="getting-started.html#setting-up-the-infrastructure">Setting up the infrastructure</a><ol><li><a href="getting-started.html#bosh-lite">BOSH-Lite</a></li><li><a href="getting-started.html#aws">AWS</a></li><li><a href="getting-started.html#vsphere-openstack">vSphere, OpenStack</a></li></ol></li><li><a href="getting-started.html#deploying-and-upgrading-concourse">Deploying and upgrading Concourse</a><ol><li><a href="getting-started.html#upload-the-stemcell">Upload the stemcell</a></li><li><a href="getting-started.html#upload-the-concourse-and-garden-releases">Upload the Concourse &amp; Garden releases</a></li><li><a href="getting-started.html#bosh-properties">Configure &amp; Deploy</a></li></ol></li></ol></li></ol></li><li><a href="fly-cli.html">The Fly CLI</a><ol><li><a href="fly-cli.html#targeting-your-concourse">Targeting your Concourse</a></li><li><a href="fly-cli.html#fly-save-target"><code>save-target</code>: Saving Concourse Targets</a></li><li><a href="fly-cli.html#fly-execute"><code>execute</code>: Submitting Local Tasks</a><ol><li><a href="fly-cli.html#multiple-inputs-to-locally-submitted-tasks">Multiple Inputs to Locally Submitted Tasks</a></li></ol></li><li><a href="fly-cli.html#fly-configure"><code>configure</code>: Configuring Pipelines</a><ol><li><a href="fly-cli.html#parameters">Parameters</a></li></ol></li><li><a href="fly-cli.html#fly-destroy-pipeline"><code>destroy-pipeline</code>: Removing Pipelines</a></li><li><a href="fly-cli.html#fly-intercept"><code>intercept</code>: Accessing a running or recent build&#39;s steps</a></li><li><a href="fly-cli.html#fly-sync"><code>sync</code>: Update your local copy of @codefly</a></li><li><a href="fly-cli.html#fly-watch"><code>watch</code>: View logs of in-progress builds</a></li></ol></li><li><a href="running-tasks.html">Tasks</a><ol><li><a href="running-tasks.html#configuring-tasks">Configuring a Task</a></li><li><a href="running-tasks.html#fly">Running tasks with <code>fly</code></a></li></ol></li><li><a href="pipelines.html">Piplines</a><ol><li><a href="configuring-resources.html"><code>resources</code>: Objects flowing through the pipeline</a></li><li><a href="configuring-jobs.html"><code>jobs</code>: Plans to execute against resources</a></li><li><a href="configuring-groups.html"><code>groups</code>: Splitting up your pipeline into sections</a></li></ol></li><li><a href="build-plans.html">Build Plans</a><ol><li><a href="get-step.html"><code>get</code>: fetch a resource</a></li><li><a href="put-step.html"><code>put</code>: update a resource</a></li><li><a href="task-step.html"><code>task</code>: execute a task</a></li><li><a href="aggregate-step.html"><code>aggregate</code>: run steps in parallel</a></li><li><a href="do-step.html"><code>do</code>: run steps in series</a></li><li><a href="step-conditions.html"><code>conditions</code>: conditionally perform a step</a></li></ol></li><li><a href="implementing-resources.html">Implementing a Resource</a><ol><li><a href="implementing-resources.html#check:-check-for-new-versions."><code>check</code>: Check for new versions.</a></li><li><a href="implementing-resources.html#in:-fetch-a-given-resource."><code>in</code>: Fetch a given resource.</a></li><li><a href="implementing-resources.html#out:-update-a-resource."><code>out</code>: Update a resource.</a></li></ol></li></ol></li></ol></div></body></html>